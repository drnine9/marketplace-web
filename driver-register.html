<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ØªØ³Ø¬ÙŠÙ„ Ø¯Ù„ÙŠÙØ±ÙŠ</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family:"Cairo",sans-serif; direction:rtl; background:#f3f4f6; padding:20px; }
    .container { max-width:500px; margin:auto; }
    .card { background:#fff; padding:20px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.08); margin-bottom:16px; }
    h2 { margin-top:0; color:#1f2937; }
    label { display:block; margin:10px 0 6px; font-weight:600; }
    input, select { width:100%; padding:12px; border:1px solid #d1d5db; border-radius:8px; }
    .btn { width:100%; padding:14px; background:#2563eb; color:#fff; border:none; border-radius:8px; font-size:16px; cursor:pointer; margin-top:12px; }
    .btn:hover { background:#1d4ed8; }
    .error { color:#ef4444; font-size:13px; margin-top:4px; display:none; }
    .note { font-size:13px; color:#6b7280; margin-top:6px; }
  </style>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <div class="container">
    <h2>ğŸï¸ ØªØ³Ø¬ÙŠÙ„ Ø¯Ù„ÙŠÙØ±ÙŠ Ø¬Ø¯ÙŠØ¯</h2>
    <div class="card">
      <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label><input id="name" type="text"/>
      <label>Ø§Ù„Ø¹Ù…Ø±</label><input id="age" type="number" min="18"/>
      <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label><input id="phone" type="tel"/>
      <label>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</label>
      <select id="area">
        <option value="">Ø§Ø®ØªØ± Ù…Ù†Ø·Ù‚ØªÙƒ</option>
        <option value="A1">Ø§Ù„Ø¹Ø§Ø´Ø± Ù…Ù† Ø±Ù…Ø¶Ø§Ù†</option>
        <option value="A2">Ø§Ù„Ø²Ù‚Ø§Ø²ÙŠÙ‚</option>
        <option value="A3">Ø¨Ù„Ø¨ÙŠØ³</option>
      </select>
      <label>Ø±Ø§Ø¨Ø· ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label><input id="username" type="text"/>
    </div>

    <div class="card">
      <label>ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (ÙˆØ¬Ù‡)</label><input id="idFront" type="file" accept="image/*"/>
      <label>ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (Ø¸Ù‡Ø±)</label><input id="idBack" type="file" accept="image/*"/>
      <label>ØµÙˆØ±Ø© Ø§Ù„Ø±Ø®ØµØ©</label><input id="license" type="file" accept="image/*"/>
      <label>ØµÙˆØ±Ø© Ø§Ù„Ù…ÙˆØªÙˆØ³ÙŠÙƒÙ„</label><input id="bike" type="file" accept="image/*"/>
    </div>

    <div class="card">
      <div class="note">ğŸ’³ Ø±Ø³ÙˆÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¥Ù„Ø²Ø§Ù…ÙŠØ© Ø¹Ø¨Ø± Ø¥Ù†Ø³ØªØ§ Ø¨Ø§ÙŠ/ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´: 01021221872 Ø£Ùˆ 01008362452</div>
      <label>Ø§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„ØªØ­ÙˆÙŠÙ„</label><input id="payerName" type="text"/>
      <label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø³Ù„</label><input id="payerPhone" type="tel"/>
      <label>ØµÙˆØ±Ø© Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹</label><input id="paymentReceipt" type="file" accept="image/*"/>
      <div id="errPayment" class="error">âŒ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙØ¹ ÙƒØ§Ù…Ù„Ø©</div>
    </div>

    <label><input id="terms" type="checkbox"/> Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·</label>
    <button class="btn" onclick="submitForm()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
  </div>

  <script>
    const tg = window.Telegram.WebApp; tg.expand();

    async function fileToBase64(input){ const f=input.files[0]; if(!f) return null; return new Promise((res,rej)=>{const r=new FileReader(); r.onload=()=>res(r.result); r.onerror=rej; r.readAsDataURL(f);}); }

    async function submitForm(){
      const payload = {
        action:"driver_register",
        name:document.getElementById("name").value.trim(),
        age:Number(document.getElementById("age").value),
        phone:document.getElementById("phone").value.trim(),
        areaId:document.getElementById("area").value,
        username:document.getElementById("username").value.trim(),
        idFront:await fileToBase64(document.getElementById("idFront")),
        idBack:await fileToBase64(document.getElementById("idBack")),
        license:await fileToBase64(document.getElementById("license")),
        bike:await fileToBase64(document.getElementById("bike")),
        payerName:document.getElementById("payerName").value.trim(),
        payerPhone:document.getElementById("payerPhone").value.trim(),
        paymentReceipt:await fileToBase64(document.getElementById("paymentReceipt")),
        terms:document.getElementById("terms").checked
      };
      if(!payload.name||!payload.age||!payload.phone||!payload.areaId||!payload.payerName||!payload.payerPhone||!payload.paymentReceipt||!payload.terms){
        document.getElementById("errPayment").style.display="block"; return;
      }
      tg.sendData(JSON.stringify(payload));
      tg.showPopup({title:"ØªÙ…",message:"âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙØ¹.",buttons:[{type:"close"}]});
      tg.close();
    }
  </script>
</body>
</html>
